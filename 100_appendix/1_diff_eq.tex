\chapter{Решавање диференцних једначина} \label{dod:diferencne}


\section*{Увод}
Диференцне једначине су једначине које су дефинисане
над бројевним низовима $x[n]$ ($n \in \mathbb N$).
Називају се још и \textit{рекурентним једначинама} 
будући да дају везу између $n$-тог члана и
преосталих чланова низа (рекурентна/рекурзивна веза).
У том смислу, диференцна једначина $k$-тог реда
је, на пример, једначина облика:
\begin{equation}
\Upphi( x[n], x[n-1], \ldots, x[n-k] ) = 0.
\end{equation}
Еквивалентно, овакве једначине могу се формулисати и дефинисањем 
текућег у односу на претходне и наредне чланове низа. 
Додатно, за јединствено решење диференцне једначине 
$k$-тог реда потребно је познавати $k$ вредности 
низа, на пример. $x[0], x[-1], \ldots, x[-k+1]$
(тзв. помоћне вредности) што 
је еквивалентно почетним условима диференцијалних 
једначина.
Решења диференцне једначине се у општем случају не 
налазе једноставно (налик на диференцијалне једначине).
Ипак, постоји поступак решавања за конкретан облик диференцних једначина погодан за примену у анализи линеарних система о коме ће бити речи и у овом 
документу. 

Најједноставнија диференцна једначина је једначина 
\begin{equation}
x[n] = kx[n-1],
\end{equation}
где је $k \in \mathbb R$ позната 
константа. Уколико усвојимо да је 
$x[0] = a$ лако се уочава шема:
\begin{eqnarray}
x[1] &=& kx[0] = ka \\
x[2] &=& kx[1] = k\cdot ka = k^2 a \\
x[3] &=& kx[2] = k\cdot k^2a = k^3 a \\
\vdots
\end{eqnarray} 
Односно, уочава се да је решење $x[n] = k^n a$. 
Практично, 
на основу формулације такве диференцне једначине 
поставља се као природно решење скалирана експоненцијална
функција $x[n] = Ck^n$. Ово је слично као у случају
диференцијалних једначина где су природна решења 
облика ${\rm e}^{\uplambda x}$. У оба случаја, заједничко
је то да под трансформацијом која дефинише једначину
(у случају диференцијалне једначине то је извод, а у
случају диференцне једначине то је \textit{кашњење}) 
природно решење \textit{не мења облик}:
\begin{eqnarray}
 e^{\uplambda t} 
\xrightarrow{\frac{{\rm d}}{{\rm d}t}}& 
\uplambda e^{\uplambda t} &\sim  {\rm e}^{\uplambda t} \\
\uplambda^{n} \xrightarrow{n\mapsto n-1}&
\uplambda^{n-1} = \dfrac{1}{\uplambda} \uplambda^{n} 
&\sim \uplambda^n 
\end{eqnarray}
Односно, као што решења линеарних диференцијалних 
једначина треба тражити у облику ${\rm e}^{\uplambda x}$
тако решења линеарних диференцних једначина треба 
тражити у облику $\uplambda^n$. 

\section*{Линеарне хомогене диференцне једначине са
константним коефицијентима}

Обична линеарна хомогена диференцна једначина $k$-тог 
реда са константним реалним коефицијентима је једначина облика: 
\begin{equation}
 a_k x[n] + a_{k-1} x[n-1] + a_{k-2} x[n-2] + 
 \ldots a_0 x[n-k] = 0, \qquad (a_j \in \mathbb R)
 \label{de2}
\end{equation}
или у еквивалентном облику 
\begin{equation}
 a_k x[n+k] + a_{k-1} x[n+k-1] + \ldots a_0 x[n] = 0
 \qquad (a_j \in \mathbb R)
 \label{lhm}
\end{equation}
Где је  познато $k$ вредности за $x[n]$. 
Претпостављајући облик решења у облику
$x[n] = \uplambda^n$ и заменом у 
\eqref{lhm} има се: 
\begin{eqnarray}
& a_k \uplambda^{n+k} + 
a_{k-1} \uplambda^{n+k-1} + 
\ldots
+ a_0 \uplambda^n = 0 \, \Rightarrow \\ 
&
\uplambda^n(
a_k \uplambda^{k} + 
a_{k-1} \uplambda^{k-1} + 
\ldots
+ a_0) = 0. \label{P}
\end{eqnarray}
Члан у загради у изразу \eqref{P} назива се 
\textit{карактеристичним полиномом} диференцне једначине:
\begin{equation}
P(\uplambda) =
a_k \uplambda^{k} + 
a_{k-1} \uplambda^{k-1} + 
\ldots
+ a_0
\end{equation}
Добијени полином је исти и за другу варијанту 
диференцне једначине као из израза \eqref{de2}.
Степен полинома одговара реду диференцне једначине 
${\rm deg}\,P = k$, и једнак је броју линеарно независних
партикуларних решења диференцне једначине. 
Зависно од структуре скупа коренова овог полинома
$\{\uplambda_1, \uplambda_2, \ldots, \uplambda_k\}$ 
одређују се и сама партикуларна решења полазне 
диференцне једначине. Пошто је посматрана диференцна
једначина линеарна, њено опште решење јесте 
свака линеарна комбинација њених партикуларних
решења, односно:
\begin{equation}
x[n] = C_1 \uplambda_1^n + C_2 \uplambda_2^n + \cdots
+ C_k \uplambda_k^n.
\end{equation}
Уколико су неки од коренова вишеструки, јасно је онда
да сви чланови $\uplambda_i^n$ нису линеарно независни. На пример, 
уколико је $\uplambda_i = \uplambda_j$ онда је  
$C_i \uplambda_i + C_j \uplambda_j = (C_i + C_j) 
\uplambda_i$ само једно партикуларно решење. Показује
се да је друго партикуларно решење у том случају 
$n\uplambda_i^n$, односно, двоструком корену 
карактеристичног полинома $\uplambda_i$ одговарају
два партикуларна решења $\uplambda_i^n$ и 
$n\uplambda_i^n$. У општем случају корена $\uplambda_i$ вишеструкости $q$ њему одговарају $q$ партикуларних
решења и то $\{\uplambda_i^n, n\uplambda_i^n, 
n^2\uplambda_i^n, \ldots, n^{q-1}\uplambda_i^n\}$. 

Будући да су разматрани коефицијенти карактеристичног
полинома реални, то његови евентуално комплексни корени  
$\underline{\uplambda}_i = \uprho {\rm e}^{{\rm j}\upphi}$ морају имати комплексно 
конјуговани пар $\underline{\uplambda}_j=\underline{\uplambda}_i^* 
= \uprho {\rm e}^{-{\rm j}\upphi}$. Овим двома 
комплексним коренима одговарају и два линеарно независна
партикуларна решења диференцне једначине и то су 
$\underline{\uplambda}_i^n$ и 
${\underline{\uplambda}_i^*}^n$. То се 
може записати и на следећи начин, применом тригонометријског облика комплексног 
броја:
%\begin{eqnarray}\setlength{\mathindent}{0pt}
\begin{align}
C_i \underline{\uplambda}_i^n
+ C_j {\underline{\uplambda}_i^*}^n =& 
C_i \uprho^n(\cos(n\upphi) + 
{\rm j}\sin(n\upphi)) 
+ C_j \uprho^n(\cos(n\upphi) - 
{\rm j}\sin(n\upphi)) \\
=& \underbrace{(C_i + C_j)}_{\underline C_i'} \uprho^n \cos(n\upphi) + 
\underbrace{ {\rm j}(C_i - C_j)}_{\underline C_j'}\uprho^n \sin(n\upphi) \label{recttrig}
\end{align}
%\end{eqnarray}
Дакле, као еквивалентан пар линеарно независних 
решења могу се посматрати и функције 
$\{\uprho^n \cos(n\upphi), 
\uprho^n \sin(n\upphi)\}$. На сличан начин, 
множењем са $n^i$, се 
могу добити и партикуларна решења за вишеструке 
комплексно конјуговане полове као у претходном случају.

\subsection*{Резиме} 
За једначине облика \eqref{lhm} или 
\eqref{de2} дефинише се карактеристични полином 
\eqref{P} чији скуп коренова одређује партикуларна 
решења према обрасцу:
\begin{itemize}
\item Сваком једноструком реалном корену $\uplambda_i$ 
одговара тачно једно партикуларно решење $\uplambda_i^n$.
\item Сваком вишеструком реалном корену $\uplambda_i$ 
вишеструкости $q$ одговара тачно $q$ партикуларних 
решења $\{\uplambda_i^n, n\uplambda_i^n, 
n^2\uplambda_i^n, \ldots, n^{q-1}\uplambda_i^n\}$
\item Сваком пару комплексно конјугованих коренова 
$\underline\uplambda_i$ и $\underline\uplambda_j 
= \underline\uplambda_i^*$ одговарају два партикуларна
решења и то $\{\uprho^n \cos(n\upphi), 
\uprho^n \sin(n\upphi)\}$.
\item Сваком пару вишеструкости $p$ комплексно конјугованих коренова 
$\underline\uplambda_i$ и $\underline\uplambda_j 
= \underline\uplambda_i^*$ одговарају $2p$
партикуларних
решења и то 
$$\{\uprho^n \cos(n\upphi), 
n\uprho^n \cos(n\upphi), 
n^2\uprho^n \cos(n\upphi), 
\ldots,
n^{p-1}\uprho^n \cos(n\upphi), 
\},$$
и
$$\{\uprho^n \sin(n\upphi), 
n\uprho^n \sin(n\upphi), 
n^2\uprho^n \sin(n\upphi), \ldots,
n^{p-1}\uprho^n \sin(n\upphi), 
\}.$$
\end{itemize}
тиме је исцрпљен скуп могућности за коренове 
карактеристичног полинома. Имајући свих $k$ 
линеарно независних партикуларних решења 
$x_{{\rm p},i}[n]$
има се коначно опште решење диференцне једначине у 
облику:
\begin{equation}
x[n] = C_1 x_{{\rm p},1}[n] +
 C_2 x_{{\rm p},2}[n] + \cdots + C_k x_{{\rm p},k}[n].
\end{equation}

\subsection*{Примери}
\noindent
\textbf{Пример 1.} Одредити решење диференцне једначине 
\begin{equation}
x[n] - 4x[n-1] + 5x[n-2] - 4x[n-3]  + 4x[n-4] = 0
\end{equation}
ако су познате помоћне вредности $x[0] = 0$, 
$x[1] = 1$, $x[2] = 11$, $x[3] = 41$. \\[2mm]
\textbf{\underline{Решење}:} Карактеристични полином 
је $P(\uplambda) = \uplambda^4 - 4 \uplambda^3 
+ 5 \uplambda^2 - 4\uplambda + 4$. Коренове полинома степена већег од два 
у општем случају није лако наћи. Ипак, постоје неке 
препоруке 
за „погађање“ корена. На пример, уколико су сви корени 
целобројни, онда 
морају делити слободни члан. Дакле, потенцијални кандидати за целобројне 
корене су у овом случају $\{1,\,-1,\,2,\,-2,\,4,\,-4\}$. 
Лако се 
проверава да су $P(1) = 1$, $P(-1) = 18$,  
{$P(2) = 0$}, $P(-2) = 80$, $P(4) = 68$, $P(-4)=612$. 
Односно, један од коренова је 2. Да би се пронашли остали
корени, потребно је полином поделити са $(\uplambda - 2)$ 
што се може извести на више начина а најефикаснији је 
применом Хорнерове шеме: \\[2mm]
%
\begin{tabular}{c|cccccl}
& $\uplambda^4$ & $\uplambda^3$ & $\uplambda^2$
& $\uplambda^1$ & 1 \\ \hline \hline
& 1 & -4 & 5 & -4 & 4 \\
\boxed{2} & 1 & -2 & 1 & -2 & & $\Rightarrow 
\uplambda^3 - 2\uplambda^2 + \uplambda - 2$
\end{tabular}\\[2mm]

\noindent
Поново се утврђује провером да је целобројни корен овог 
полинома 2, односно, поступак треба поновити још једном:
\\[2mm]
\begin{tabular}{c|cccccl}
& $\uplambda^3$ & $\uplambda^2$ & $\uplambda^1$
& 1 \\ \hline \hline
& 1 & -2  & 1 & -2 \\
\boxed{2} & 1 & 0 & 1 & & $\Rightarrow 
\uplambda^2 + 1$
\end{tabular}\\[2mm]
Преостали су још само корени 
полинома $\uplambda^2 + 1$ што су $\{{\rm j}, -{\rm j}\}$.


Коначно, сви корени карактеристичног полинома су
$[2,2,{\rm j},-{\rm j}]$. Двоструком корену 
$\uplambda_1 = 2$ одговарају два партикуларна решења
и то $x_{\rm p,1}[n] = 2^n$ и $x_{\rm p,2}[n] = n 2^n$.
Конјугованом пару $\{{\rm j}, -{\rm j}\}$ одговарају 
два партикуларна решења. 
$\left\{ 
\cos\left( 
\dfrac{n\uppi}{2}
\right),
\sin\left( 
\dfrac{n\uppi}{2}
\right)
\right\}
$
Опште решење је облика:
\begin{equation}
x[n] = C_1 2^n + C_2 n2^n + C_3
\cos\left( 
\dfrac{n\uppi}{2}
\right)
+ C_4
\sin\left( 
\dfrac{n\uppi}{2}
\right)
\end{equation}
Заменом помоћних вредности у добијено опште решење 
добија се систем једначина:
\begin{equation}
\begin{aligned}
x[0] &= 0 = \, C_1 + C_3 \\
x[1] &= 1 = \, 2C_1 + 2C_2 + C_4 \\
x[2] &= 11 = \, 4C_1 + 8C_2 - C_3\\
x[3] &= 41 = \, 8C_1 + 24C_2 - C_4.
\end{aligned}
\end{equation}
Решавањем добијеног система једначина добијају се 
непознате константе 
$C_1 = -1$, $C_2 = 2$, $C_3 = 1$, $C_4 = -1$. Заменом
у опште решење и сређивањем добија се коначни резултат
\begin{equation}
x[n] = (2n - 1)2^n + \cos\left( 
\dfrac{n\uppi}{2}
\right)
-
\sin\left( 
\dfrac{n\uppi}{2}
\right)
\end{equation}
\begin{flushright}
$\blacksquare$
\end{flushright}

\noindent
\textbf{Пример 2.} Одредити решење диференцне једначине
\begin{equation}
x[n] + x[n-1] - x[n-2] - x[n-3] = 0
\end{equation}
које задовољава $x[0] = 2$, $x[1] = -1$ и 
$x[2] = 3$. \\[2mm]
\textbf{\underline{Решење}:} Карактеристични полином
је $P(\uplambda) = \uplambda^3 + \uplambda^2 
- \uplambda - 1$. Полином се може директно факторисати
\begin{align}
P(\uplambda) & = \uplambda^3 + \uplambda^2 
- \uplambda - 1 \\
& = \uplambda^2 (\uplambda + 1) 
- (\uplambda + 1) \\
& = (\uplambda^2 - 1) (\uplambda + 1) \\
& = (\uplambda - 1) (\uplambda + 1)^2. 
\end{align}
Такав карактеристични полином има корене 
$[1, -1, -1]$ на основу чега има опште решење: 
\begin{equation}
x[n] = C_1 + (C_2 + C_3 n) (-1)^n.
\end{equation}
Заменом помоћних вредности добија се систем 
једначина:
\begin{align*}
x[0] = 2 =&\, C_1 + C_2 \\
x[1] = -1 =&\, C_1 - C_2 - C_3 \\
x[2] = 3 =&\, C_1 + C_2 + 2C_3
\end{align*}
Решења овог система једначина су 
$C_1 = \dfrac{3}{4}$, $C_2 = \dfrac{5}{4}$, 
$C_3 = \dfrac{1}{2}$. Коначно решење примера је:
\begin{equation}
x[n] = \dfrac{3}{4} + \left( \dfrac{5}{4} + 
\dfrac{1}{2} n \right) (-1)^n
\end{equation}
